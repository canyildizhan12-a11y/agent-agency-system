"use strict";(()=>{var e={};e.id=582,e.ids=[582],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},2663:(e,t,n)=>{n.r(t),n.d(t,{config:()=>c,default:()=>l,routeModule:()=>d});var s={};n.r(s),n.d(s,{default:()=>u});var i=n(1802),a=n(7153),r=n(6249),o=n(5763);async function u(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{id:n}=e.query,{task:s,sessionKey:i,spawnComplete:a}=e.body;if(!n||"string"!=typeof n)return t.status(400).json({error:"Agent ID required"});let r=n.toLowerCase(),u=o.I8[r];if(!u)return t.status(400).json({error:`Unknown agent: ${r}`});if((0,o.MA)(r)){let e=(0,o.pr)(r);return t.status(200).json({success:!0,agentId:r,agentName:u.name,agentEmoji:u.emoji,status:"already_awake",message:`${u.name} is already awake`,session:e})}if(a&&i){let e=(0,o.xB)(r,i,s||"General task");return t.status(200).json({success:!0,agentId:r,agentName:u.name,agentEmoji:u.emoji,status:"awake",message:`${u.name} has been spawned successfully`,session:e})}let l=s||"Check in and report status",c=(0,o.RF)(r,l);t.status(202).json({success:!0,agentId:r,agentName:u.name,agentEmoji:u.emoji,status:"spawn_queued",message:`${u.name} spawn request queued. Main agent will spawn the subagent shortly.`,requestId:c.id,task:l,maxSessionMinutes:o.of,identityContext:(0,o.WP)(r)})}let l=(0,r.l)(s,"default"),c=(0,r.l)(s,"config"),d=new i.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/wake",pathname:"/api/wake",bundlePath:"",filename:""},userland:s})},5763:(e,t,n)=>{n.d(t,{I8:()=>d,MA:()=>S,RF:()=>g,WP:()=>y,gw:()=>x,nZ:()=>j,of:()=>c,pr:()=>w,xB:()=>h});var s=n(2048),i=n.n(s),a=n(5315),r=n.n(a);let o="/home/ubuntu/.openclaw/workspace/agent-agency",u=r().join(o,"active_sessions.json"),l=r().join(o,"spawn_queue.json"),c=60,d={henry:{id:"henry",name:"Henry",emoji:"\uD83E\uDD89",role:"Team Lead",personality:"Wise, strategic facilitator",skills:"planning, coordination, team management"},scout:{id:"scout",name:"Scout",emoji:"\uD83D\uDD0D",role:"Researcher",personality:"Curious, detail-oriented",skills:"monitoring, analysis, QA testing"},pixel:{id:"pixel",name:"Pixel",emoji:"\uD83C\uDFA8",role:"Creative",personality:"Visual, enthusiastic",skills:"design, aesthetics, UI/UX"},echo:{id:"echo",name:"Echo",emoji:"\uD83D\uDCBE",role:"Memory",personality:"Reliable, organized",skills:"state management, logs, archiving"},quill:{id:"quill",name:"Quill",emoji:"✍️",role:"Copywriter",personality:"Wordsmith, storyteller",skills:"writing, documentation, editing"},codex:{id:"codex",name:"Codex",emoji:"\uD83C\uDFD7️",role:"Architect",personality:"Systematic, big-picture thinker",skills:"systems design, architecture, strategy"},alex:{id:"alex",name:"Alex",emoji:"\uD83D\uDEE1️",role:"Security Lead",personality:"Vigilant, protective, uncompromising",skills:"security, compliance, oversight, policy enforcement"},vega:{id:"vega",name:"Vega",emoji:"\uD83D\uDCCA",role:"Data Analyst",personality:"Data-driven, analytical",skills:"metrics, analytics, reporting, visualization"}};function m(){if(!i().existsSync(u))return[];try{return JSON.parse(i().readFileSync(u,"utf8"))}catch{return[]}}function p(e){let t=r().dirname(u);i().existsSync(t)||i().mkdirSync(t,{recursive:!0}),i().writeFileSync(u,JSON.stringify(e,null,2))}function g(e,t){let n={id:f(),agentId:e.toLowerCase(),task:t,requestedAt:new Date().toISOString(),status:"pending"},s=function(){if(!i().existsSync(l))return[];try{return JSON.parse(i().readFileSync(l,"utf8"))}catch{return[]}}();return s.push(n),function(e){let t=r().dirname(l);i().existsSync(t)||i().mkdirSync(t,{recursive:!0}),i().writeFileSync(l,JSON.stringify(e,null,2))}(s),n}function y(e){let t=d[e.toLowerCase()];if(!t)throw Error(`Unknown agent: ${e}`);let n=r().join(o,"agents",e.toLowerCase(),"identity.yaml");return`You are ${t.name} ${t.emoji}

ROLE: ${t.role}
PERSONALITY: ${t.personality}
SKILLS: ${t.skills}

CRITICAL RULES:
1. ALWAYS stay in character as ${t.name}
2. Start EVERY response with ${t.emoji}
3. Refer to your identity file: ${n}
4. Use your professional expertise
5. Be proactive and suggest next steps
6. NEVER break character

You have been spawned as a subagent session. Your session will auto-terminate after ${c} minutes.

Your task will be provided in the next message.`}function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function x(){let e=m(),t=new Date,n=e.filter(e=>"active"===e.status&&(!(t>new Date(e.expiresAt))||(e.status="completed",!1)));return n.length!==e.length&&p(n),n}function S(e){return x().some(t=>t.agentId===e.toLowerCase())}function w(e){return x().find(t=>t.agentId===e.toLowerCase())||null}function h(e,t,n){let s=t.split(":").pop()||f(),a=new Date().toISOString(),u=new Date(Date.now()+6e4*c).toISOString(),l={agentId:e.toLowerCase(),sessionKey:t,uuid:s,spawnedAt:a,expiresAt:u,task:n,status:"active"},d=m().filter(t=>t.agentId!==e.toLowerCase());return d.push(l),p(d),function(e,t,n){let s=r().join(o,"session_logs","spawns.json"),a=r().dirname(s);i().existsSync(a)||i().mkdirSync(a,{recursive:!0});let u={timestamp:new Date().toISOString(),event:"spawn",agentId:e,sessionKey:t,task:n.substring(0,100)+(n.length>100?"...":"")},l=[];i().existsSync(s)&&(l=JSON.parse(i().readFileSync(s,"utf8"))),l.push(u),i().writeFileSync(s,JSON.stringify(l.slice(-100),null,2))}(e,t,n),l}function j(e){let t=m(),n=t.findIndex(t=>t.agentId===e.toLowerCase()&&"active"===t.status);if(-1===n)return{success:!1,message:`${e} is already sleeping (no active session)`};let s=t[n].sessionKey;return t[n].status="completed",p(t),function(e,t){let n=r().join(o,"session_logs","spawns.json"),s={timestamp:new Date().toISOString(),event:"sleep",agentId:e,sessionKey:t},a=[];i().existsSync(n)&&(a=JSON.parse(i().readFileSync(n,"utf8"))),a.push(s),i().writeFileSync(n,JSON.stringify(a.slice(-100),null,2))}(e,s),{success:!0,message:`${e} put to sleep (session terminated)`,sessionKey:s}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=2663);module.exports=n})();