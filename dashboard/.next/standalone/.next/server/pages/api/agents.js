"use strict";(()=>{var e={};e.id=299,e.ids=[299],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},4589:(e,t,n)=>{n.r(t),n.d(t,{config:()=>y,default:()=>d,routeModule:()=>f});var r={};n.r(r),n.d(r,{default:()=>m});var s=n(1802),a=n(7153),i=n(6249),o=n(4614),l=n(2048),c=n.n(l),u=n(5315),p=n.n(u);let g="/home/ubuntu/.openclaw/workspace/agent-agency";async function m(e,t){if("GET"===e.method)try{let e=p().join(g,"agents.json"),n=JSON.parse(c().readFileSync(e,"utf8")).agents.map(e=>{let t=(0,o.r9)(e.id),n=p().join(g,"sleeping_agents",`${e.id}.json`),r="sleeping",s=null,a=null;if(c().existsSync(n)){let e=JSON.parse(c().readFileSync(n,"utf8"));r=e.status||"sleeping",s=e.current_task||e.last_task,a=e.woken_at,t&&(r="working")}return{id:e.id,name:e.name,emoji:e.emoji,role:e.role,personality:e.personality,skills:e.skills,status:r,lastTask:s,wokenAt:a,isActive:t}});t.status(200).json(n)}catch(e){console.error("Error fetching agents:",e),t.status(500).json({error:e.message})}else if("POST"===e.method){let{agentId:n,task:r,message:s}=e.body;if(!n)return t.status(400).json({error:"Agent ID required"});try{let e=await (0,o.BZ)(n,r||s||"Wake up and standby"),a=p().join(g,"sleeping_agents",`${n}.json`);if(c().existsSync(a)){let e=JSON.parse(c().readFileSync(a,"utf8"));e.status="awake",e.woken_at=new Date().toISOString(),e.woken_by="dashboard",e.current_task=r||s,c().writeFileSync(a,JSON.stringify(e,null,2))}t.status(200).json({success:!0,agentId:n,agentName:e.name,agentEmoji:e.emoji,message:`üöÄ ${n} is now awake and working`,openclawResult:e})}catch(e){console.error("Error spawning agent:",e),t.status(500).json({error:e.message})}}else t.status(405).json({error:"Method not allowed"})}let d=(0,i.l)(r,"default"),y=(0,i.l)(r,"config"),f=new s.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/agents",pathname:"/api/agents",bundlePath:"",filename:""},userland:r})},4614:(e,t,n)=>{n.d(t,{uF:()=>w,Uf:()=>k,r9:()=>h,BZ:()=>f,_:()=>y});let r=require("child_process");var s=n(2048),a=n.n(s),i=n(5315),o=n.n(i);let l="/home/ubuntu/.openclaw/workspace",c=o().join(l,"agent-agency"),u=o().join(c,"session_cache");a().existsSync(u)||a().mkdirSync(u,{recursive:!0});let p={henry:{name:"Henry",emoji:"\uD83E\uDD89",role:"Team Lead",personality:"Wise, strategic facilitator",skills:"planning, coordination"},scout:{name:"Scout",emoji:"\uD83D\uDD0D",role:"Researcher",personality:"Curious, detail-oriented",skills:"monitoring, analysis"},pixel:{name:"Pixel",emoji:"\uD83C\uDFA8",role:"Creative",personality:"Visual, enthusiastic",skills:"design, aesthetics"},echo:{name:"Echo",emoji:"\uD83D\uDCBE",role:"Memory",personality:"Practical, efficient",skills:"state management, logs"},quill:{name:"Quill",emoji:"‚úçÔ∏è",role:"Copywriter",personality:"Wordsmith, storyteller",skills:"writing, content"},codex:{name:"Codex",emoji:"\uD83C\uDFD7Ô∏è",role:"Architect",personality:"Big-picture thinker",skills:"systems, strategy"},alex:{name:"Alex",emoji:"\uD83D\uDEE1Ô∏è",role:"Security Lead",personality:"Vigilant, protective",skills:"security, compliance, oversight"},vega:{name:"Vega",emoji:"\uD83D\uDCCA",role:"Data Analyst",personality:"Data-driven, analytical",skills:"metrics, analytics, reporting"}},g={};function m(e,t){return`[${e.emoji} ${e.name}|${e.role}] ${e.personality}. Skills: ${e.skills}. RULES: Stay in character. Start with ${e.emoji}. TASK: ${t}`}function d(e,t){return`You are ${e.name}, ${e.role} ${e.emoji}

PERSONALITY: ${e.personality}
EXPERTISE: ${e.skills}

CRITICAL RULES:
1. ALWAYS stay in character as ${e.name}
2. Start EVERY response with ${e.emoji}
3. Use your professional expertise
4. Be proactive and suggest next steps
5. NEVER break character

[TASK FROM CAN via AGENCY DASHBOARD]
${t}

Execute this task as ${e.name}. Provide your response in character.`}async function y(e,t){let n=p[e.toLowerCase()];if(!n)throw Error(`Unknown agent: ${e}`);let r=m(n,t);return S(e,n,r,t)}async function f(e,t){let n=p[e.toLowerCase()];if(!n)throw Error(`Unknown agent: ${e}`);let r=d(n,t);return S(e,n,r,t)}async function S(e,t,n,s){let i=`/tmp/agent-task-${e}-${Date.now()}.txt`;a().writeFileSync(i,n);try{console.log(`[Agent Agency] Spawning ${t.name} for task...`);let u=function(e){let t=g[e.toLowerCase()];if(t&&Date.now()-t.lastUsed<3e5)try{return process.kill(t.pid,0),{pid:t.pid,sessionId:t.sessionId}}catch{delete g[e.toLowerCase()]}return null}(e);u&&console.log(`[Agent Agency] Using cached session for ${t.name}`);let p=Date.now(),m=n.replace(/"/g,'\\"').replace(/\n/g," "),d=(0,r.execSync)(`cd ${l} && openclaw agent --agent ${e} -m "${m}" 2>&1`,{encoding:"utf8",timeout:12e4,env:{...process.env,OPENCLAW_WORKSPACE:l}}),y=Date.now()-p;return a().unlinkSync(i),function(e,t,n){let r=o().join(c,"sleeping_agents",`${e.toLowerCase()}.json`);if(a().existsSync(r)){let e=JSON.parse(a().readFileSync(r,"utf8"));e.status=t,e.current_task=n,e.updated_at=new Date().toISOString(),a().writeFileSync(r,JSON.stringify(e,null,2))}}(e,"working",s),function(e,t,n,r){let s=o().join(c,"token_logs","performance.json"),i={timestamp:new Date().toISOString(),agentId:e,duration:t,inputChars:n,outputChars:r,estimatedTokens:Math.ceil((n+r)/4)},l=[];a().existsSync(s)&&(l=JSON.parse(a().readFileSync(s,"utf8"))),l.push(i),a().writeFileSync(s,JSON.stringify(l.slice(-100),null,2))}(e,y,n.length,d.length),{agentId:e,name:t.name,emoji:t.emoji,status:"working",output:d.substring(0,2e3),message:`${t.emoji} ${t.name} completed the task`,duration:y,cached:!!u}}catch(n){return a().unlinkSync(i),console.error(`Error spawning ${e}:`,n),{agentId:e,name:t.name,emoji:t.emoji,status:"error",error:n.message,output:n.stdout?.substring(0,1e3)||"No output"}}}function h(e){return!!p[e.toLowerCase()]}async function w(e,t,n){let s=t.includes(" ")?t:`0 */${parseInt(t)||1} * * *`;try{let t=(0,r.execSync)(`cd ${l} && openclaw cron add --name "${e}" --schedule "${s}" --message "${n}" --target isolated 2>&1`,{encoding:"utf8",timeout:3e4});return{success:!0,output:t}}catch(e){return{success:!1,error:e.message}}}function k(){let e=p.echo,t="Analyze dashboard performance",n=m(e,t).split(" ").length,r=d(e,t).split(" ").length,s=r-n;return{compressed:n,full:r,savings:s,percentage:Math.round(s/r*100)}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=4589);module.exports=n})();