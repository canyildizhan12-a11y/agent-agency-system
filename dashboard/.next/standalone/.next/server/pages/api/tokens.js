"use strict";(()=>{var e={};e.id=197,e.ids=[197],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},8521:(e,t,n)=>{n.r(t),n.d(t,{config:()=>h,default:()=>f,routeModule:()=>m});var r={};n.r(r),n.d(r,{default:()=>g});var a=n(1802),o=n(7153),s=n(6249),i=n(2048),u=n.n(i),l=n(5315),c=n.n(l),d=n(4614);let p=c().join("/home/ubuntu/.openclaw/workspace/agent-agency","token_logs");async function g(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});let{agentId:n,range:r="today"}=e.query;try{let e=(0,d.Uf)(),r=function(e,t){new Date().toISOString().split("T")[0];let n=u().readdirSync(p).filter(e=>e.endsWith(".json")&&!e.includes("performance")),r=0,a=0,o=0,s={},i={};for(let e of n){let n=e.replace(".json",""),l=c().join(p,e);try{for(let e of JSON.parse(u().readFileSync(l,"utf8")))t&&e.agentId!==t||(r+=e.totalTokens||0,a+=e.inputTokens||0,o+=e.outputTokens||0,s[e.agentId]||(s[e.agentId]={tokens:0,requests:0}),s[e.agentId].tokens+=e.totalTokens||0,s[e.agentId].requests+=1,i[n]||(i[n]=0),i[n]+=e.totalTokens||0)}catch{}}return{totalTokens:r,totalInput:a,totalOutput:o,byAgent:s,byDay:i,estimatedCost:function(e){let t=e/1e3*.003;return{usd:Math.round(100*t)/100,local:`$${t.toFixed(3)} USD`}}(r)}}(0,n),a=function(){let e=c().join(p,"performance.json");if(!u().existsSync(e))return{avgDuration:0,totalRequests:0,avgTokens:0};try{let t=JSON.parse(u().readFileSync(e,"utf8"));if(0===t.length)return{avgDuration:0,totalRequests:0,avgTokens:0};let n=t.reduce((e,t)=>e+(t.duration||0),0),r=t.reduce((e,t)=>e+(t.estimatedTokens||0),0);return{avgDuration:Math.round(n/t.length),totalRequests:t.length,avgTokens:Math.round(r/t.length),last24h:t.filter(e=>new Date(e.timestamp).getTime()>Date.now()-864e5).length}}catch{return{avgDuration:0,totalRequests:0,avgTokens:0}}}();t.status(200).json({success:!0,optimization:e,usage:r,performance:a,generatedAt:new Date().toISOString()})}catch(e){t.status(500).json({error:e.message})}}let f=(0,s.l)(r,"default"),h=(0,s.l)(r,"config"),m=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/tokens",pathname:"/api/tokens",bundlePath:"",filename:""},userland:r})},4614:(e,t,n)=>{n.d(t,{uF:()=>g,Uf:()=>f});let r=require("child_process");var a=n(2048),o=n.n(a),s=n(5315),i=n.n(s);let u="/home/ubuntu/.openclaw/workspace",l=i().join(u,"agent-agency"),c=i().join(l,"session_cache");o().existsSync(c)||o().mkdirSync(c,{recursive:!0});let d={echo:{name:"Echo",emoji:"\uD83D\uDCBE",role:"Memory",personality:"Practical, efficient",skills:"state management, logs"}},p={};async function g(e,t,n){let a=t.includes(" ")?t:`0 */${parseInt(t)||1} * * *`;try{let t=(0,r.execSync)(`cd ${u} && openclaw cron add --name "${e}" --schedule "${a}" --message "${n}" --target isolated 2>&1`,{encoding:"utf8",timeout:3e4});return{success:!0,output:t}}catch(e){return{success:!1,error:e.message}}}function f(){var e,t;let n=d.echo,r="Analyze dashboard performance",a=(e=n,t=r,`[${e.emoji} ${e.name}|${e.role}] ${e.personality}. Skills: ${e.skills}. RULES: Stay in character. Start with ${e.emoji}. TASK: ${t}`).split(" ").length,o=`You are ${n.name}, ${n.role} ${n.emoji}

PERSONALITY: ${n.personality}
EXPERTISE: ${n.skills}

CRITICAL RULES:
1. ALWAYS stay in character as ${n.name}
2. Start EVERY response with ${n.emoji}
3. Use your professional expertise
4. Be proactive and suggest next steps
5. NEVER break character

[TASK FROM CAN via AGENCY DASHBOARD]
${r}

Execute this task as ${n.name}. Provide your response in character.`.split(" ").length,s=o-a;return{compressed:a,full:o,savings:s,percentage:Math.round(s/o*100)}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=8521);module.exports=n})();